<div class="reset-password-container">
  <div class="reset-password-card">
    <div class="logo-section">
      <div class="logo-icon">
        <ion-icon name="key"></ion-icon>
      </div>
      <h2>Nueva Contraseña</h2>
      <p>Ingresa tu nueva contraseña segura</p>
    </div>

    <!-- Mensaje de error -->
    <div *ngIf="errorMessage" class="error-message">
      <ion-icon name="alert-circle-outline"></ion-icon>
      {{ errorMessage }}
    </div>

    <!-- Mensaje de éxito -->
    <div *ngIf="successMessage" class="success-message">
      <ion-icon name="checkmark-circle-outline"></ion-icon>
      {{ successMessage }}
    </div>

    <form (ngSubmit)="onSubmit()" class="reset-password-form" #resetForm="ngForm">
      <!-- Nueva Contraseña -->
      <div class="form-group">
        <label for="newPassword">Nueva Contraseña</label>
        <div class="input-with-icon">
          <ion-icon name="lock-closed-outline"></ion-icon>
          <input [type]="showPassword ? 'text' : 'password'" id="newPassword" 
            [(ngModel)]="newPassword" name="newPassword" placeholder="••••••••" 
            [disabled]="isLoading" required (ngModelChange)="validatePassword()" />
          <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'" 
            class="toggle-password" (click)="togglePasswordVisibility()"></ion-icon>
        </div>
        <p class="field-error" *ngIf="passwordError">{{ passwordError }}</p>
        
        <!-- Indicadores de fortaleza -->
        <div class="password-strength" *ngIf="newPassword">
          <div class="strength-indicator" [class.valid]="hasMinLength">
            <ion-icon [name]="hasMinLength ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
            <span>Mínimo 8 caracteres</span>
          </div>
          <div class="strength-indicator" [class.valid]="hasUpperCase">
            <ion-icon [name]="hasUpperCase ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
            <span>Una letra mayúscula</span>
          </div>
          <div class="strength-indicator" [class.valid]="hasSpecialChar">
            <ion-icon [name]="hasSpecialChar ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
            <span>Un carácter especial (!@#$%^&*)</span>
          </div>
        </div>
      </div>

      <!-- Confirmar Contraseña -->
      <div class="form-group">
        <label for="confirmPassword">Confirmar Contraseña</label>
        <div class="input-with-icon">
          <ion-icon name="lock-closed-outline"></ion-icon>
          <input [type]="showConfirmPassword ? 'text' : 'password'" 
            id="confirmPassword" [(ngModel)]="confirmPassword" 
            name="confirmPassword" placeholder="••••••••" 
            [disabled]="isLoading" required (ngModelChange)="validateConfirm()" />
          <ion-icon [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'" 
            class="toggle-password" (click)="toggleConfirmPasswordVisibility()"></ion-icon>
        </div>
        <p class="field-error" *ngIf="confirmError">{{ confirmError }}</p>
      </div>

      <!-- Botón -->
      <button type="submit" class="btn-primary btn-full" 
        [disabled]="isLoading || !resetForm.form.valid || !isPasswordValid()">
        <ion-icon *ngIf="!isLoading" name="checkmark-done-outline"></ion-icon>
        <ion-icon *ngIf="isLoading" name="hourglass-outline" class="spinner"></ion-icon>
        {{ isLoading ? 'Cambiando...' : 'Cambiar Contraseña' }}
      </button>
    </form>

    <div class="back-link">
      <p>
        <span (click)="goToLogin()" class="link-accent">
          <ion-icon name="arrow-back-outline"></ion-icon>
          Volver al inicio de sesión
        </span>
      </p>
    </div>
  </div>
</div>